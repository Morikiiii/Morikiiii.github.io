


<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>  Unity 导航系统 |    Morikiiii | &#39;ColdDog&#39; Space</title>
  <meta name="description" content="Morikiiii Not Human">
  <!-- 标签页图标 -->
  
  <link rel="shortcut icon" href="https://raw.githubusercontent.com/Morikiiii/FigureBed/main/img/MorikiiiiLogo.png" type="image/x-icon">
  

  <!-- 图标库 -->
  <link href="https://cdn.jsdelivr.net/npm/remixicon@2.2.0/fonts/remixicon.css" rel="stylesheet">
  <!-- 动画库 -->
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fushaolei/cdn-white@1.0/css/animate.css"/>
  
  <!-- css文件 -->
  
<link rel="stylesheet" href="/css/white.css">

  <!-- 代码高亮 -->
  
    
      
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.1.1/styles/github.css">

    
  
<meta name="generator" content="Hexo 6.2.0"></head>


<body>

<div class="menu-outer">
    <div class="menu-inner">
      <div class="menu-site-name  animate__animated  animate__fadeInUp">
        <a href="/">
          Morikiiii | &#39;ColdDog&#39; Space
        </a>
        
      </div>
      <div class="menu-group">
        <ul class="menu-ul">
        
          <a href="/" class="nav-link">
            <li class="menu-li  animate__animated  animate__fadeInUp">
              HOME
            </li>
          </a>
        
          <a href="/archives" class="nav-link">
            <li class="menu-li  animate__animated  animate__fadeInUp">
              BLOG
            </li>
          </a>
        
        
          <li class="menu-li animate__animated  animate__fadeInUp" id="sort">
             SOME
             <div class="categories-outer " id="sort-div">
               <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/C-Study/">C# Study</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/EveryDay/">EveryDay</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Novels/">Novels</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Other/">Other</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Unity-Study/">Unity Study</a></li></ul>
             </div>
          </li>
        
        
          <li class="menu-li animate__animated  animate__fadeInUp" id="mobile-menu">
            <i class="ri-menu-line"></i>
          </li>
        
        </ul>

      </div>

    </div>
</div>
<div id="mobile-main" class="animate__animated  animate__fadeIn">
  <div class="mobile-menu-inner">
    <div class="mobile-menu-site-name animate__animated  animate__fadeInUp">
      <a href="/">
        Morikiiii | &#39;ColdDog&#39; Space
      </a>
    </div>
    <div class="mobile-menu-group" id="mobile-close">
      <i class="ri-close-line"></i>
    </div>

  </div>

  <div class="mobile-menu-div">
  
    <a href="/" class="mobile-nav-link">
      <div class="mobile-menu-child animate__animated  animate__fadeInUp">
        <span>HOME</span>
      </div>
    </a>
  
    <a href="/archives" class="mobile-nav-link">
      <div class="mobile-menu-child animate__animated  animate__fadeInUp">
        <span>BLOG</span>
      </div>
    </a>
  
  
  </div>


</div>

<div class="body-outer">
  <div class="body-inner">
    
<article class="post-inner">
  <div class="post-content-outer">
    <div class="post-intro">
      <div class="post-title animate__animated  animate__fadeInUp">Unity 导航系统</div>
      <div class="meta-intro animate__animated  animate__fadeInUp">9月 14 2022</div>
      
    </div>
    <div class="post-content-inner">
      <div class="post-content-inner-space">

      </div>
      <div class="post-content-main animate__animated  animate__fadeInUp">
        <!-- top型目录 -->
        
        <h2 id="NavMeshAgent-组件"><a href="#NavMeshAgent-组件" class="headerlink" title="NavMeshAgent 组件"></a>NavMeshAgent 组件</h2><h4 id="介绍"><a href="#介绍" class="headerlink" title="| 介绍"></a>| 介绍</h4><p>首先来看两个情况：</p>
<ul>
<li><p>很多网络游戏中都有一个功能，点击地图上的某个位置，角色自动跑到这个位置</p>
</li>
<li><p>RTS 和 Moba 类游戏中鼠标右键点击一个位置，角色自动走向这个位置，并且还具备规避障碍物的能力</p>
</li>
</ul>
<p>以上使用的功能就是导航，或者叫寻路，主要具备两个特点</p>
<ul>
<li><p>以最短路径前往目标</p>
</li>
<li><p>规避障碍物</p>
</li>
</ul>
<h4 id="烘培"><a href="#烘培" class="headerlink" title="| 烘培"></a>| 烘培</h4><p>既然要导航，那必须先确定一张“地图”，确定玩家什么地方可以去、什么地方不可以去</p>
<ul>
<li><p>Navigation（导航）面板</p>
</li>
<li><p>功能：导航面板的主要功能就是规划场景中哪里可以去哪里不可以去</p>
</li>
<li><p>面板：Window-》Al-》Navigation</p>
</li>
</ul>
<p>这个面板之后课程我们会单独来说，但是需要导航就必须先简单烘焙一下地图才能进行下去</p>
<ol>
<li>选择场景中，将地形、场景相关的游戏物体设置为Static模式，这是烘焙的前提</li>
<li>直接选择子栏目Bake</li>
<li>点击Bake按钮</li>
<li>场景中部分区域呈现成蓝色，意味着烘焙成功，蓝色就是角色可以前往的地方</li>
</ol>
<h4 id="核心组件"><a href="#核心组件" class="headerlink" title="| 核心组件"></a>| 核心组件</h4><ul>
<li><p>现在的场景已经确定了那些地方角色可以前往，但是具体如何进行导航？</p>
<ul>
<li><p>这就需要游戏物体身上具备NavMeshAgent这个组件，导航代理组件承担具体如何导航的计算</p>
</li>
<li><p>添加这个导航代理组件的游戏物体，身上会增加一个圆柱体形状的碰撞体</p>
</li>
</ul>
</li>
<li><p><strong>面板：</strong></p>
</li>
</ul>
<ol>
<li><p>Agent Type： 代理类型，我们在Navigation中添加类型，主要是设置这个角色的尺寸    </p>
</li>
<li><p>Base Offset：碰撞体和角色的高度偏移</p>
</li>
<li><p>Speed：导航时的最大移动速度</p>
</li>
<li><p>Angular Speed：导航时的最大旋转速度</p>
</li>
<li><p>Acceleration：导航刚开始时加速到Speed需要的程度，越大越快</p>
</li>
<li><p>Stopping Distance：距离终点多远则停止</p>
</li>
<li><p>Auto Braking：勾选后表示到达目标点或离目标点的距离满足 StoppingDistance 时自动停止，如果不勾选即使到达终点，角色也围着终点转来转去</p>
</li>
</ol>
<h4 id="障碍规避"><a href="#障碍规避" class="headerlink" title="| 障碍规避"></a>| 障碍规避</h4><ul>
<li><p><strong>Avoidance</strong></p>
</li>
<li><p><strong>障碍回避设置：</strong></p>
<ul>
<li>Radius：碰撞体半径</li>
<li>Height：碰撞体高度</li>
<li>Quality：躲避障碍物的行为质量，质量越高躲避行为越好，越智能</li>
<li>Prioritv：优先级，范围为0-99，（0优先级最高，99优先级最低），高优先级的Agent不会与低优先级的Agent进行碰撞</li>
</ul>
</li>
<li><p><strong>NavMeshAgent 常用属性与方法：</strong></p>
<ul>
<li>导航系统的代码相关操作都要先 <code>using UnityEngine.AI;</code> 命名空间</li>
</ul>
</li>
<li><p><strong>常用方法：</strong></p>
<ul>
<li><code>navMeshAgent.SetDestination(vector3)</code> ：设置导航，填写目标位置</li>
</ul>
</li>
<li><p><strong>常用属性：</strong></p>
<ul>
<li><code>navMeshAgent.isStopped</code> ：获取和修改是否停止导航</li>
</ul>
</li>
</ul>
<pre><code class="csharp">using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.AI;


public class L9_1Demo : MonoBehaviour
&#123;
    private NavMeshAgent agent;
    public Transform target;
    void Start()
    &#123;
        agent = GetComponent&lt;NavMeshAgent&gt;();
    &#125;

    void Update()
    &#123;
        agent.SetDestination(target.position);
        if (Input.GetKeyDown(KeyCode.Space))
        &#123;
            agent.isStopped = !agent.isStopped;
        &#125;
    &#125;
&#125;
</code></pre>
<hr>
<h2 id="Navigation-面板"><a href="#Navigation-面板" class="headerlink" title="Navigation 面板"></a>Navigation 面板</h2><p>导航面板分为四部分</p>
<ul>
<li><p><strong>Agents</strong></p>
<ul>
<li><p>Agents 代理设置</p>
</li>
<li><p>对需要进行导航的角色进行分类，默认有一个 Humanoid，也就是人类。</p>
</li>
<li><p>但是常规情况下不使用，导航网格并不基于这个生成</p>
</li>
<li><p>主要设置：</p>
<ul>
<li><p>Name：名称</p>
</li>
<li><p>Radius：半径 </p>
</li>
<li><p>Hieght:：高度</p>
</li>
<li><p>Step Height：能上多高的台阶</p>
</li>
<li><p>Max Slope：能上多陡峭的坡度</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Areas</strong></p>
<ul>
<li><p>在游戏场景中，不同区域的行走代价是不同的，比如陆地肯定比沼泽地走起来更快，所谓代价就是移动成本，代价越高的地方，导航系统会尽可能绕过去</p>
</li>
<li><p>Areas面板主要用来设置不同区域的不同成本，但是这里只有预先设计好不同区域类型的成本，并不能直接设置场景中具体“这个游戏物体属于什么区域”</p>
</li>
</ul>
</li>
<li><p><strong>Bake</strong></p>
<ul>
<li><p>这个面板中有很多 Agents 相关的设置，实际上是在设置一个最极限的情况，可以理解成需要导航的最小单位，设置等同与 Agents 面板</p>
</li>
<li><p>点击 Bake 生成导航网格</p>
</li>
</ul>
</li>
<li><p><strong>Object</strong></p>
<ul>
<li><p>Scene Filter：场景过滤，主要影响层级面板中的显示</p>
</li>
<li><p>选中一个游戏物体后，Object 面板中会出现一定的变化，我们会发现只有静态物体可以进行 Navigation Areas（导航区域）的设置，这也意味着只有静态物体可以烘焙到导航网格中</p>
</li>
<li><p>Navigation Areas：设置所选游戏物体的区域设置，可以多选游戏物体</p>
</li>
</ul>
</li>
</ul>
<hr>
<h2 id="NavMeshObstacle-组件"><a href="#NavMeshObstacle-组件" class="headerlink" title="NavMeshObstacle 组件"></a>NavMeshObstacle 组件</h2><h4 id="组件"><a href="#组件" class="headerlink" title="| 组件"></a>| 组件</h4><p>目前我们的导航网格，是通过将地形游戏物体设置为静态模式，然后导航烘焙后实现，但是游戏中可能存在这种情况:RTS或Moba类型游戏中，可能因为玩家的建造、角色的技能，出现一个障碍物，我们右键移动角色得到时候，需要避开这些障碍物</p>
<p>按照我们目前所学，其实是达不到的，所以这节课我们需要学习导航 NavMeshObstacle 障碍物组件</p>
<h4 id="属性"><a href="#属性" class="headerlink" title="| 属性"></a>| 属性</h4><p>这个组件用起来十分方便，直接给游戏物体添加这个组件可</p>
<p><strong>参数：</strong></p>
<p>Shape：形状，类似碰撞体的蓝色外框，但是实际上并不具备碰撞体的特性，可以穿模，仅仅用于导航计算上 </p>
<p>Center：中心点</p>
<p>Size：尺寸</p>
<p>Carve：不勾选的情况。该障碍物只是阻挡了物体前进路线，并没有改变物体导航网格的路径（导航只会不断的计算最短路径依旧认为此条路径是最短的不会重新计算路径）。物体不会绕过该障碍物进行导航</p>
<hr>
<h2 id="案例：鼠标点击移动"><a href="#案例：鼠标点击移动" class="headerlink" title="案例：鼠标点击移动"></a>案例：鼠标点击移动</h2><p>应用之前学习的动画系统、射线、导航系统等知识来完成一个点击移动的小案例</p>
<pre><code class="csharp">using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.AI;

public class L9_4Demo : MonoBehaviour
&#123;
    private Animator animator;
    private NavMeshAgent agent;

    void Start()
    &#123;
        animator = GetComponent&lt;Animator&gt;();
        agent = GetComponent&lt;NavMeshAgent&gt;();
    &#125;

    void Update()
    &#123;
        if (Input.GetMouseButtonDown(1))
        &#123;
            Ray ray = Camera.main.ScreenPointToRay(Input.mousePosition);

            if (Physics.Raycast(ray, out RaycastHit hitinfo, 1000))
            &#123;
                // hitinfo: 射线碰撞的相关信息
                Debug.DrawLine(ray.origin, hitinfo.point, Color.red);
                agent.SetDestination(hitinfo.point);
                animator.SetBool(&quot;Run&quot;, true);
                agent.isStopped = false;
            &#125;
        &#125;

        if(Vector3.Distance(transform.position,agent.destination)&lt;=agent.stoppingDistance)
        &#123;
            animator.SetBool(&quot;Run&quot;, false);
            agent.isStopped = true;
        &#125;
    &#125;
&#125;
</code></pre>
<hr>
<br>

<center>👾森木清树👾</center>

<br>

        <!-- 分类文章 -->
        
          <div class="post-categoris-bottom">
            <div class="post-categoris-name">Unity Study</div>
            <ul>
            
            
              
            
            
            
              
            
            
            
              
            
            
            
              
            
            
            
              
            
            
            
              
            
            
            
              
            
            
            
              
            
            
            
              
            
            
            
              
                <li class="base">
                  <a  href="/2022/09/06/Unity/Unity%E5%9F%BA%E7%A1%80%E6%93%8D%E4%BD%9C/" class="post-categoris-bottom-link">
                  Unity 基础操作
                </a>
                </li>
              
              
            
            
            
              
                <li class="base">
                  <a  href="/2022/09/07/Unity/Unity%E7%BB%84%E4%BB%B6%E6%80%9D%E6%83%B3/" class="post-categoris-bottom-link">
                  unity 组件思想
                </a>
                </li>
              
              
            
            
            
              
                <li class="base">
                  <a  href="/2022/09/08/Unity/Unity-2D%E9%83%A8%E5%88%86/" class="post-categoris-bottom-link">
                  Unity 2D部分
                </a>
                </li>
              
              
            
            
            
              
                <li class="base">
                  <a  href="/2022/09/09/Unity/Unity-%E8%BE%93%E5%85%A5%E7%B3%BB%E7%BB%9F/" class="post-categoris-bottom-link">
                  Unity 输入系统
                </a>
                </li>
              
              
            
            
            
              
                <li class="base">
                  <a  href="/2022/09/10/Unity/Unity-UI%E7%B3%BB%E7%BB%9F(1)/" class="post-categoris-bottom-link">
                  Unity UI系统（1）
                </a>
                </li>
              
              
            
            
            
              
                <li class="base">
                  <a  href="/2022/09/10/Unity/Unity-UI%E7%B3%BB%E7%BB%9F%EF%BC%882%EF%BC%89/" class="post-categoris-bottom-link">
                  Unity UI系统（2）
                </a>
                </li>
              
              
            
            
            
              
            
            
            
              
                <li class="base">
                  <a  href="/2022/09/12/Unity/Unity-3D%E9%83%A8%E5%88%86/" class="post-categoris-bottom-link">
                  Unity 3D部分
                </a>
                </li>
              
              
            
            
            
              
                <li class="base">
                  <a  href="/2022/09/12/Unity/Unity-%E6%B8%B2%E6%9F%93%E5%9F%BA%E7%A1%80/" class="post-categoris-bottom-link">
                  Unity 渲染基础
                </a>
                </li>
              
              
            
            
            
              
                <li class="base">
                  <a  href="/2022/09/12/Unity/Unity-%E5%8A%A8%E7%94%BB%E7%B3%BB%E7%BB%9F/" class="post-categoris-bottom-link">
                  Unity 动画系统
                </a>
                </li>
              
              
            
            
            
              
                <li class="me base">
                  <a  href="/2022/09/14/Unity/Unity-%E5%AF%BC%E8%88%AA%E7%B3%BB%E7%BB%9F/" class="post-categoris-bottom-link">
                  Unity 导航系统
                </a>
                </li>
              
              
            
            
            
              
                <li class="base">
                  <a  href="/2022/09/14/Unity/Unity-%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86/" class="post-categoris-bottom-link">
                  Unity 资源管理
                </a>
                </li>
              
              
            
            
            
              
            
            
            
              
            
            
            
              
            
            
            
              
            
            
            
              
                <li class="base">
                  <a  href="/2022/09/24/Unity/Flappy-Bird/" class="post-categoris-bottom-link">
                  Flappy Bird
                </a>
                </li>
              
              
            
            
            
              
            
            
            
              
            
            
            
              
            
            
            
              
                <li class="base">
                  <a  href="/2022/10/16/Unity/MMORPG/" class="post-categoris-bottom-link">
                  MMORPG
                </a>
                </li>
              
              
            
            
            
              
            
            
            
              
                <li class="base">
                  <a  href="/2022/11/16/Unity/MMORPG-2/" class="post-categoris-bottom-link">
                  MMORPG(2)
                </a>
                </li>
              
              
            
            
            
              
            
            
            
              
            
            
            
              
            
            
            
              
            
            
            
              
            
            
            
              
            
            
            
              
                <li class="base">
                  <a  href="/2023/01/12/Unity/Unity-Xlua/" class="post-categoris-bottom-link">
                  Unity+Xlua
                </a>
                </li>
              
              
            
            
            
              
            
            
            </ul>

          </div>

        
      </div>
      <div class="post-content-inner-space">
        
          <div class="space-toc-main animate__animated  animate__fadeInUp">
            <ol class="space-toc"><li class="space-toc-item space-toc-level-2"><a class="space-toc-link" href="#NavMeshAgent-%E7%BB%84%E4%BB%B6"><span class="space-toc-text">NavMeshAgent 组件</span></a><ol class="space-toc-child"><li class="space-toc-item space-toc-level-4"><a class="space-toc-link" href="#%E4%BB%8B%E7%BB%8D"><span class="space-toc-text">| 介绍</span></a></li><li class="space-toc-item space-toc-level-4"><a class="space-toc-link" href="#%E7%83%98%E5%9F%B9"><span class="space-toc-text">| 烘培</span></a></li><li class="space-toc-item space-toc-level-4"><a class="space-toc-link" href="#%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6"><span class="space-toc-text">| 核心组件</span></a></li><li class="space-toc-item space-toc-level-4"><a class="space-toc-link" href="#%E9%9A%9C%E7%A2%8D%E8%A7%84%E9%81%BF"><span class="space-toc-text">| 障碍规避</span></a></li></ol></li></ol></li><li class="space-toc-item space-toc-level-2"><a class="space-toc-link" href="#Navigation-%E9%9D%A2%E6%9D%BF"><span class="space-toc-text">Navigation 面板</span></a></li><li class="space-toc-item space-toc-level-2"><a class="space-toc-link" href="#NavMeshObstacle-%E7%BB%84%E4%BB%B6"><span class="space-toc-text">NavMeshObstacle 组件</span></a><ol class="space-toc-child"><li class="space-toc-item space-toc-level-4"><a class="space-toc-link" href="#%E7%BB%84%E4%BB%B6"><span class="space-toc-text">| 组件</span></a></li><li class="space-toc-item space-toc-level-4"><a class="space-toc-link" href="#%E5%B1%9E%E6%80%A7"><span class="space-toc-text">| 属性</span></a></li></ol></li></ol></li><li class="space-toc-item space-toc-level-2"><a class="space-toc-link" href="#%E6%A1%88%E4%BE%8B%EF%BC%9A%E9%BC%A0%E6%A0%87%E7%82%B9%E5%87%BB%E7%A7%BB%E5%8A%A8"><span class="space-toc-text">案例：鼠标点击移动</span></a></li></ol>
           </div>
        
      </div>
   </div>
    <!-- 评论 -->
    
  </div>
</article>
  </div>
</div>



<!-- 如果是home模式的话，不在首页就显示footer，如果不是home模式的话 所有都显示footer -->

  <div class="footer-outer animate__animated  animate__fadeInUp">
    <div class="footer-inner">
    <div class="footer-text">
    <p>Power by <a target="_blank" rel="noopener" href="http://hexo.io/">Hexo</a> Theme by <a target="_blank" rel="noopener" href="https://github.com/FuShaoLei/hexo-theme-white">White</a> Player by <a target="_blank" rel="noopener" href="https://github.com/Morikiiii">Morikiiii</a></p>

    </div>
    <div class="footer-contact">
    <ul class="footer-ul">
        
        <li class="footer-li">
            <a href="https://github.com/Morikiiii" target="_blank">
                <i class="ri-github-line"></i>
            </a>
        </li>
        
        <li class="footer-li">
            <a href="mailto:Morikiiii@163.com" target="_blank">
                <i class="ri-mail-line"></i>
            </a>
        </li>
        
        <li class="footer-li">
            <a href="https://space.bilibili.com/88008879?spm_id_from=333.1007.0.0" target="_blank">
                <i class="ri-bilibili-line"></i>
            </a>
        </li>
        
        <li class="footer-li">
            <a href="https://music.163.com/#/user/home?id=105580982" target="_blank">
                <i class="ri-netease-cloud-music-line"></i>
            </a>
        </li>
        
    </ul>
    </div>
    </div>
</div>






<script src="/js/white.js"></script>



    
      
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.1/build/highlight.min.js"></script>

      <script>hljs.initHighlightingOnLoad();</script>
    

<script async>window.onload=function(){var a=document.createElement('script'),b=document.getElementsByTagName('script')[0];a.type='text/javascript',a.async=!0,a.src='/sw-register.js?v='+Date.now(),b.parentNode.insertBefore(a,b)};</script></body></html>